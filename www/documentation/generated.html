<html xmlns="http://www.w3.org/1999/xhtml" xmlns:c="http://www.w3.org/ns/xproc-step"><head>
        <title>xprocspec</title>
        <meta charset="utf-8"/>
        <script class="remove" src="http://darobin.github.com/respec/builds/respec-w3c-common.js"> </script>
        <script class="remove">
            var respecConfig = {
                "specStatus": "unofficial",
                "shortName": "xprocspec",
                "subtitle": "A tool for testing XProc scripts",
                "edDraftURI": "http://josteinaj.github.io/xprocspec/www/documentation/index.html",
                "editors": [
                    {
                        "name": "Jostein Austvik Jacobsen",
                        "url": "http://github.com/josteinaj",
                        "company": "NLB",
                        "companyURL": "http://www.nlb.no/en/"
                    }
                ]
            };
        </script>
        <style>
            /* based on the CSS used for the HTML5 spec */
            h2 + h3,
            h3 + h4,
            h4 + h5,
            h5 + h6{
                margin-top:0.5em;
            }
            h1,
            h2,
            h3,
            h4,
            h5,
            h6{
                page-break-after:avoid;
            }
            h3{
                position:relative;
                z-index:3;
                padding-top:20px;
            }
            h2 + .element,
            h2 + div + .element,
            h3 + .element,
            h3 + div + .element,
            h4 + .element,
            h4 + div + .element,
            h5 + .element,
            h5 + div + .element,
            h6 + .element,
            h6 + div + .element{
                margin-top:-3em;
                padding-top:2em;
            }
            .element{
                background:#F4F4FA;
                color:black;
                margin:0 0 1em 0.15em;
                padding:0 1em 1em 0.75em;
                border-left:solid #9999FF 0.25em;
                position:relative;
                z-index:1;
            }
            .element:before{
                position:absolute;
                z-index:2;
                top:0;
                left:-1.15em;
                height:2em;
                width:0.9em;
                background:#F4F4FA;
                content:' ';
                border-style:none none solid solid;
                border-color:#9999FF;
                border-width:0.25em;
            }
            section{
                padding-bottom:20px;
            }
            dt{
                padding-top:10px;
            }
            dd{
                padding-top:5px;
            }</style>
    </head>
    <body>
        <section id="abstract">xprocspec is a tool for testing XProc scripts. This specification defines the grammar used to define XProc tests for use with xprocspec. This document is automatically generated based on the <a href="../../src/main/resources/xml/schema/xprocspec.rng">Relax NG schema for the xprocspec grammar</a>.</section>
        
<section xmlns:x="http://www.daisy.org/ns/pipeline/xproc/test" xmlns:f="http://www.daisy.org/ns/pipeline/xproc/test/internal-functions" xmlns:rng="http://relaxng.org/ns/structure/1.0" xmlns:a="http://relaxng.org/ns/compatibility/annotations/1.0">
<h2>Definitions</h2>
<section id="the-description-element">
<h2>The <code>description</code> element</h2><dl class="element"><dt>Content model:</dt><dd><a href="#the-pending-element"><code>pending</code></a><small title="optional">?</small></dd><dd><a href="#the-import-element"><code>import</code></a><small title="zero or more">*</small></dd><dd><a href="#the-scenario-element"><code>scenario</code></a><small title="zero or more">*</small></dd><dt>Content attributes:</dt><dd><a href="#attr-description-script"><code>script</code></a>
                                                -- type: anyURI</dd><dd><a href="#attr-description-version"><code>version</code></a><small title="optional">?</small>
                                                -- type: NMTOKEN</dd><dd>Zero or more attributes from any namespace.</dd></dl>
<p id="attr-description-script">The <code>script</code> attribute is a URI that points to the XProc script you want to test.</p>
<p id="attr-description-version">The <code>version</code> attribute can be used to aid development over time.</p>
<p>The <code>description</code> element is the root element of an xprocspec test and describes the functionality of a specific XProc script.</p>
</section>
<section id="the-pending-element">
<h2>The <code>pending</code> element</h2><dl class="element"><dt>Content model:</dt><dd><a href="#the-label-element"><code>label</code></a><small title="optional">?</small></dd><dd><a href="#the-scenario-element"><code>scenario</code></a><small title="zero or more">*</small></dd><dd><a href="#the-expect-element"><code>expect</code></a><small title="zero or more">*</small></dd><dt>Content attributes:</dt><dd><a href="#attr-pending-label"><code>label</code></a><small title="optional">?</small></dd><dd>Zero or more attributes from any namespace.</dd></dl>
<p id="attr-pending-label"><em>TODO</em>: the attribute <code>label</code> has not been documented yet.</p>
<p>
                Anything that is within a &lt;pending&gt; element will remain untested, but will be
                reported as (eventual) desired behaviour. This is a good way of commenting out
                a set of behaviours that haven't been implemented yet, or scenarios whose
                desired behaviour hasn't been determined, or tests for code that you're not
                currently working on, to make the testing process faster.
                
                An optional label attribute can be used to describe why the scenario or
                assertion should not be tested.
            </p>
</section>
<section id="the-pending-element">
<h2>The <code>pending</code> element</h2><dl class="element"><dt>Content model:</dt><dd><a href="#the-label-element"><code>label</code></a><small title="optional">?</small></dd><dd><a href="#the-scenario-element"><code>scenario</code></a><small title="zero or more">*</small></dd><dd><a href="#the-expect-element"><code>expect</code></a><small title="zero or more">*</small></dd><dt>Content attributes:</dt><dd><a href="#attr-pending-label"><code>label</code></a><small title="optional">?</small></dd><dd>Zero or more attributes from any namespace.</dd></dl>
<p id="attr-pending-label"><em>TODO</em>: the attribute <code>label</code> has not been documented yet.</p>
<p>
                Anything that is within a &lt;pending&gt; element will remain untested, but will be
                reported as (eventual) desired behaviour. This is a good way of commenting out
                a set of behaviours that haven't been implemented yet, or scenarios whose
                desired behaviour hasn't been determined, or tests for code that you're not
                currently working on, to make the testing process faster.
                
                An optional label attribute can be used to describe why the scenario or
                assertion should not be tested.
            </p>
</section>
<section id="the-import-element">
<h2>The <code>import</code> element</h2><dl class="element"><dt>Content model:</dt><dd>Empty.</dd><dt>Content attributes:</dt><dd><a href="#attr-import-href"><code>href</code></a>
                                                -- type: anyURI</dd><dd>Zero or more attributes from any namespace.</dd></dl>
<p id="attr-import-href"><em>TODO</em>: the attribute <code>href</code> has not been documented yet.</p>
<p>
                An import brings in all the scenarios from the referenced file (which must
                itself be an xprocspec description). All the unshared scenarios in that imported
                xprocspec will be run on the stylesheet that this xprocspec document describes.
                Importing is recursive and may be circular (although only one copy of a given
                imported document will actually be imported).
            </p>
</section>
<section id="the-scenario-element">
<h2>The <code>scenario</code> element</h2><dl class="element"><dt>Content model:</dt><dd><a href="#the-call-element"><code>call</code></a></dd><dd><a href="#the-label-element"><code>label</code></a><small title="optional">?</small></dd><dd><a href="#the-like-element"><code>like</code></a><small title="zero or more">*</small></dd><dd><a href="#the-scenario-element"><code>scenario</code></a><small title="zero or more">*</small></dd><dd><a href="#the-context-element"><code>context</code></a><small title="zero or more">*</small></dd><dd><a href="#the-expect-element"><code>expect</code></a><small title="zero or more">*</small></dd><dt>Content attributes:</dt><dd><a href="#attr-scenario-label"><code>label</code></a><small title="optional">?</small></dd><dd>Zero or more attributes from any namespace.</dd></dl>
<p id="attr-scenario-label"><em>TODO</em>: the attribute <code>label</code> has not been documented yet.</p>
<p>
                A step scenario is one based on a call to a pipeline. The &lt;call&gt;
                element defines the step call and the inputs, options and parameters passed to it and the
                &lt;assertion&gt; elements test the ports of the pipeline. Child scenarios
                can override the ports, options and parameters in the template call.
            </p>
</section>
<section id="the-call-element">
<h2>The <code>call</code> element</h2><dl class="element"><dt>Content model:</dt><dd><a href="#the-option-element"><code>option</code></a><small title="zero or more">*</small></dd><dd><a href="#the-param-element"><code>param</code></a><small title="zero or more">*</small></dd><dd><a href="#the-input-element"><code>input</code></a><small title="zero or more">*</small></dd><dt>Content attributes:</dt><dd><a href="#attr-call-step"><code>step</code></a><small title="optional">?</small>
                                                -- type: QName</dd><dd>Zero or more attributes from any namespace.</dd></dl>
<p id="attr-call-step"><em>TODO</em>: the attribute <code>step</code> has not been documented yet.</p>
<p>
                A &lt;call&gt; element defines a step call and the
                inputs, options and parameters passed to it.
            </p>
</section>
<section id="the-label-element">
<h2>The <code>label</code> element</h2><dl class="element"><dt>Content model:</dt><dd>Zero or more elements from any namespace.</dd><dt>Content attributes:</dt><dd>Zero or more attributes from any namespace.</dd></dl>
<p><em>TODO</em>: the element <code>label</code> has not been documented yet.</p>
</section>
<section id="the-context-element">
<h2>The <code>context</code> element</h2><dl class="element"><dt>Content model:</dt><dd><a href="#the-label-element"><code>label</code></a><small title="optional">?</small></dd><dd><a href="#the-document-element"><code>document</code></a><small title="oen or more">+</small></dd><dt>Content attributes:</dt><dd><a href="#attr-context-label"><code>label</code></a><small title="optional">?</small></dd><dd>Zero or more attributes from any namespace.</dd></dl>
<p id="attr-context-label"><em>TODO</em>: the attribute <code>label</code> has not been documented yet.</p>
<p>Defines the context against which assertions</p>
</section>
<section id="the-expect-element">
<h2>The <code>expect</code> element</h2><dl class="element"><dt>Content model:</dt><dd><a href="#the-label-element"><code>label</code></a><small title="optional">?</small></dd><dd><a href="#the-document-element"><code>document</code></a><small title="zero or more">*</small></dd><dt>Content attributes:</dt><dd><a href="#attr-expect-grammar"><code>grammar</code></a><small title="optional">?</small>
                                                -- values: 
                                                <code>relax-ng</code>, <code>schematron</code>, <code>xml-schema</code></dd><dd><a href="#attr-expect-label"><code>label</code></a><small title="optional">?</small></dd><dd><a href="#attr-expect-test"><code>test</code></a><small title="optional">?</small></dd><dd><a href="#attr-expect-type"><code>type</code></a><small title="optional">?</small></dd><dd>Zero or more attributes from any namespace.</dd></dl>
<p id="attr-expect-grammar"><em>TODO</em>: the attribute <code>grammar</code> has not been documented yet.</p>
<p id="attr-expect-label"><em>TODO</em>: the attribute <code>label</code> has not been documented yet.</p>
<p id="attr-expect-test"><em>TODO</em>: the attribute <code>test</code> has not been documented yet.</p>
<p id="attr-expect-type"><em>TODO</em>: the attribute <code>type</code> has not been documented yet.</p>

                <p>
                Defines what is expected from the context document(s).
                The types of expectations are as follows:</p>
                <dl>
                  <dt>XPath assertion:</dt>
                  <dd>The <code>test</code> attribute can be used to perform XPath tests
                  against each of the input documents. The XPath expression
                  is evaluated once against each document in the context.
                  The test succeeds if the XPath expression does not fail
                  when evaluated against any of the context documents.</dd>
                  <dt>Document comparison:</dt>
                  <dd>If no <code>test</code> attribute is present, then the sequence of
                  documents in the context will be compared to the sequence
                  of documents defined by the <code>document</code> elements inside the
                  <code>expect</code> element. The <code>document</code> element can be used to
                  refer to ports (both inputs and outputs), directory
                  listings (recursive and non-recursive) and file contents
                  (<code>xml</code>, <code>html</code>, <code>text</code>, <code>binary</code>).
                  <!-- TODO: possibly also information about a file or directory (size, readable, writable, hidden, last-modified) ? -->
                  </dd>
                </dl>
            
</section>
<section id="the-option-element">
<h2>The <code>option</code> element</h2><dl class="element"><dt>Content model:</dt><dd>Empty.</dd><dt>Content attributes:</dt><dd><a href="#attr-option-base-uri"><code>base-uri</code></a><small title="optional">?</small>
                                                -- values: 
                                                <code>temp-dir</code></dd><dd><a href="#attr-option-name"><code>name</code></a><small title="optional">?</small>
                                                -- type: QName</dd><dd><a href="#attr-option-select"><code>select</code></a><small title="optional">?</small></dd><dd>Zero or more attributes from any namespace.</dd></dl>
<p id="attr-option-base-uri"><em>TODO</em>: the attribute <code>base-uri</code> has not been documented yet.</p>
<p id="attr-option-name"><em>TODO</em>: the attribute <code>name</code> has not been documented yet.</p>
<p id="attr-option-select"><em>TODO</em>: the attribute <code>select</code> has not been documented yet.</p>
<p><em>TODO</em>: the element <code>option</code> has not been documented yet.</p>
</section>
<section id="the-param-element">
<h2>The <code>param</code> element</h2><dl class="element"><dt>Content model:</dt><dd>Empty.</dd><dt>Content attributes:</dt><dd><a href="#attr-param-base-uri"><code>base-uri</code></a><small title="optional">?</small>
                                                -- values: 
                                                <code>temp-dir</code></dd><dd><a href="#attr-param-name"><code>name</code></a><small title="optional">?</small>
                                                -- type: QName</dd><dd><a href="#attr-param-select"><code>select</code></a><small title="optional">?</small></dd><dd>Zero or more attributes from any namespace.</dd></dl>
<p id="attr-param-base-uri"><em>TODO</em>: the attribute <code>base-uri</code> has not been documented yet.</p>
<p id="attr-param-name"><em>TODO</em>: the attribute <code>name</code> has not been documented yet.</p>
<p id="attr-param-select"><em>TODO</em>: the attribute <code>select</code> has not been documented yet.</p>
<p><em>TODO</em>: the element <code>param</code> has not been documented yet.</p>
</section>
<section id="the-input-element">
<h2>The <code>input</code> element</h2><dl class="element"><dt>Content model:</dt><dd><a href="#the-document-element"><code>document</code></a><small title="zero or more">*</small></dd><dt>Content attributes:</dt><dd>Zero or more attributes from any namespace.</dd></dl>
<p><em>TODO</em>: the element <code>input</code> has not been documented yet.</p>
</section>
<section id="the-call-element">
<h2>The <code>call</code> element</h2><dl class="element"><dt>Content model:</dt><dd><a href="#the-option-element"><code>option</code></a><small title="zero or more">*</small></dd><dd><a href="#the-param-element"><code>param</code></a><small title="zero or more">*</small></dd><dd><a href="#the-input-element"><code>input</code></a><small title="zero or more">*</small></dd><dt>Content attributes:</dt><dd><a href="#attr-call-step"><code>step</code></a><small title="optional">?</small>
                                                -- type: QName</dd><dd>Zero or more attributes from any namespace.</dd></dl>
<p id="attr-call-step"><em>TODO</em>: the attribute <code>step</code> has not been documented yet.</p>
<p>
                A &lt;call&gt; element defines a step call and the
                inputs, options and parameters passed to it.
            </p>
</section>
<section id="the-option-element">
<h2>The <code>option</code> element</h2><dl class="element"><dt>Content model:</dt><dd>Empty.</dd><dt>Content attributes:</dt><dd><a href="#attr-option-base-uri"><code>base-uri</code></a><small title="optional">?</small>
                                                -- values: 
                                                <code>temp-dir</code></dd><dd><a href="#attr-option-name"><code>name</code></a>
                                                -- type: QName</dd><dd><a href="#attr-option-select"><code>select</code></a></dd><dd>Zero or more attributes from any namespace.</dd></dl>
<p id="attr-option-base-uri"><em>TODO</em>: the attribute <code>base-uri</code> has not been documented yet.</p>
<p id="attr-option-name"><em>TODO</em>: the attribute <code>name</code> has not been documented yet.</p>
<p id="attr-option-select"><em>TODO</em>: the attribute <code>select</code> has not been documented yet.</p>
<p><em>TODO</em>: the element <code>option</code> has not been documented yet.</p>
</section>
<section id="the-param-element">
<h2>The <code>param</code> element</h2><dl class="element"><dt>Content model:</dt><dd>Empty.</dd><dt>Content attributes:</dt><dd><a href="#attr-param-base-uri"><code>base-uri</code></a><small title="optional">?</small>
                                                -- values: 
                                                <code>temp-dir</code></dd><dd><a href="#attr-param-name"><code>name</code></a>
                                                -- type: QName</dd><dd><a href="#attr-param-select"><code>select</code></a></dd><dd>Zero or more attributes from any namespace.</dd></dl>
<p id="attr-param-base-uri"><em>TODO</em>: the attribute <code>base-uri</code> has not been documented yet.</p>
<p id="attr-param-name"><em>TODO</em>: the attribute <code>name</code> has not been documented yet.</p>
<p id="attr-param-select"><em>TODO</em>: the attribute <code>select</code> has not been documented yet.</p>
<p><em>TODO</em>: the element <code>param</code> has not been documented yet.</p>
</section>
<section id="the-input-element">
<h2>The <code>input</code> element</h2><dl class="element"><dt>Content model:</dt><dd><a href="#the-document-element"><code>document</code></a><small title="zero or more">*</small></dd><dt>Content attributes:</dt><dd>Zero or more attributes from any namespace.</dd></dl>
<p><em>TODO</em>: the element <code>input</code> has not been documented yet.</p>
</section>
<section id="the-like-element">
<h2>The <code>like</code> element</h2><dl class="element"><dt>Content model:</dt><dd><a href="#the-label-element"><code>label</code></a><small title="optional">?</small></dd><dt>Content attributes:</dt><dd><a href="#attr-like-label"><code>label</code></a><small title="optional">?</small></dd><dd>Zero or more attributes from any namespace.</dd></dl>
<p id="attr-like-label"><em>TODO</em>: the attribute <code>label</code> has not been documented yet.</p>
<p>
                The &lt;like&gt; element pulls a shared scenario into this one (which may be shared
                or unshared). Any environment set within the shared scenario is merged with
                this one, and any tests in the shared scenario are run in addition to the
                ones in this scenario. This allows for modular, reusable sets of tests which
                can be applied in multiple contexts.
            </p>
</section>
<section id="the-document-element">
<h2>The <code>document</code> element</h2><dl class="element"><dt>Content model:</dt><dd>One element from any namespace. (optional)</dd><dt>Content attributes:</dt><dd><a href="#attr-document-base-uri"><code>base-uri</code></a><small title="optional">?</small>
                                                -- values: 
                                                <code>temp-dir</code></dd><dd><a href="#attr-document-errors"><code>errors</code></a><small title="optional">?</small></dd><dd><a href="#attr-document-href"><code>href</code></a><small title="optional">?</small>
                                                -- type: anyURI</dd><dd><a href="#attr-document-method"><code>method</code></a><small title="optional">?</small>
                                                -- values: 
                                                <code>xml</code>, <code>html</code>, <code>text</code>, <code>binary</code></dd><dd><a href="#attr-document-port"><code>port</code></a><small title="optional">?</small>
                                                -- type: QName</dd><dd><a href="#attr-document-position"><code>position</code></a><small title="optional">?</small>
                                                -- values: 
                                                <code>all</code>, <code>last</code>, 
                                                            or any value of type <code>integer</code></dd><dd><a href="#attr-document-recursive"><code>recursive</code></a><small title="optional">?</small>
                                                -- type: boolean</dd><dd><a href="#attr-document-type"><code>type</code></a><small title="optional">?</small></dd><dd>Zero or more attributes from any namespace.</dd></dl>
<p id="attr-document-base-uri"><em>TODO</em>: the attribute <code>base-uri</code> has not been documented yet.</p>
<p id="attr-document-errors"><em>TODO</em>: the attribute <code>errors</code> has not been documented yet.</p>
<p id="attr-document-href"><em>TODO</em>: the attribute <code>href</code> has not been documented yet.</p>
<p id="attr-document-method"><em>TODO</em>: the attribute <code>method</code> has not been documented yet.</p>
<p id="attr-document-port"><em>TODO</em>: the attribute <code>port</code> has not been documented yet.</p>
<p id="attr-document-position"><em>TODO</em>: the attribute <code>position</code> has not been documented yet.</p>
<p id="attr-document-recursive"><em>TODO</em>: the attribute <code>recursive</code> has not been documented yet.</p>
<p id="attr-document-type"><em>TODO</em>: the attribute <code>type</code> has not been documented yet.</p>

                <p>The <code>document</code> element is used to define which documents are provided on a steps input ports, what the context is when making assertions, and for assertions when making comparisons. It can be used in a number of ways:</p>
                <dl>
                    <dt>Inline:</dt>
                    <dd>If type <code>type</code> attribute is <code>inline</code>, then the <code>document</code> element is replaced by its content. There must be exactly one element inside the <code>document</code> element. To specify the base URI of the document, you can specify a
                        <code>xml:base</code> on either the <code>document</code> element (implicit base URI) or the child element itself (explicit base URI). The <code>xml:base</code> on <code>document</code> element is resolved against the base URI of the xprocspec test document, or if the
                        <code>base-uri</code> attribute has the value <code>temp-dir</code>, it will be resolved against the temporary directory used for the test. If the <code>base-uri</code> attribute has the value <code>temp-dir</code> without specifying a <code>xml:base</code> attribute on the
                        <code>document</code> element, then the <code>document</code> element will have the temporary directory used for the test as its base URI.</dd>
                    <dt>Port:</dt>
                    <dd>If the <code>type</code> attribute is <code>port</code>, then the <code>document</code> element will be replaced with the documents on that port. The <code>position</code> attribute can be used to select only part of the sequence of documents appearing on that
                        port.</dd>
                    <dt>File:</dt>
                    <dd>If the <code>type</code> attribute is <code>file</code>, then the <code>document</code> element will be replaced by the contents of the file located at the location pointed to by the <code>file</code> attribute. The default method for reading files is <code>xml</code>, but using
                        the <code>method</code> attribute you can also choose <code>html</code>, <code>text</code> and <code>binary</code> as methods for loading the file. The <code>file</code> URI is by default resolved against the base URI of the xprocspec test document. However, if you provide the
                        <code>base-uri</code> attribute with a value of <code>temp-dir</code>, then the <code>file</code> URI will be resolved against the temporary directory used for the test instead.</dd>
                    <dt>Directory:</dt>
                    <dd>If the <code>type</code> attribute is <code>directory</code>, then the <code>document</code> element will be replaced with a directory listing of the directory pointed to by the <code>directory</code> attribute. By default, the result is the same as invoking the
                        standard XProc step p:directory-list. If you specify the <code>recursive</code> attribute and give it the value <code>true</code>, you will get a recursive directory listing, listing all subfolders and their contents as well. The <code>directory</code> URI is
                        by default resolved against the base URI of the xprocspec test document. However, if you provide the <code>base-uri</code> attribute with a value of <code>temp-dir</code>, then the <code>directory</code> URI will be resolved against the temporary directory
                        used for the test instead.</dd>
                </dl>
            
</section>
</section>
        <section class="appendix">
            <h2>Acknowledgements</h2>
            <p>This structure of this specification is generated with the help of <a href="https://github.com/darobin/respec" target="_blank">respec</a> (for the W3C-style specification).</p>
            <p>The xprocspec implementation itself currently depends on the XProc processor <a href="http://xmlcalabash.com/" target="_blank">XML Calabash</a></p>
        </section>
    

</body></html>